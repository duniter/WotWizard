WotWizard : Mode d'emploi

This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.


WotWizard construit, à partir de la chaîne de blocs et de la piscine de Duniter, une prédiction des futures entrées des candidats dans la toile de confiance (TdC, ou Wot en anglais) de Duniter. Il utilise pour cela une simulation du mécanisme de Duniter. Lorsque plusieurs dates d'entrées sont possibles pour la même personne, chacune est affectée d'une probabilité. La liste affichée est mise à jour automatiquement toutes les cinq minutes, et tout changement est signalé par une marque visible.
WotWizard contient aussi plusieurs outils complémentaires et un Explorateur de Toile de Confiance rapide.

Attention : Il est nécessaire d'utiliser la version 1.7.17 de Duniter ou une version ultérieure de la série 1.7.x.
Comment l'utiliser ?
Ce programme doit être utilisé sur un ordinateur faisant tourner un nœud Duniter.
Ce programme tourne nativement sous Windows. Si votre ordinateur tourne sous Linux, installez d'abord "wine", et, dans un terminal, lancez "winecfg" et configurez les lecteurs de façon à pouvoir atteindre sans problème la base de données de Duniter (voir ci-dessous).

Le nœud Duniter doit être configuré pour WotWizard. Pour cela, éditez son fichier de configuration ("conf.json", dans son répertoire ; voir Configuration ci-dessous) en mettant la valeur du champ "storage.wotwizard" à "true".
Mode Serveur
Vous pouvez utiliser WotWizard uniquement comme serveur, si vous voulez assurer vous-même l'affichage de ses résultats, par exemple dans une page web. Dans ce cas, placez une copie des deux fichiers "WWCmds.exe" et "WWUpdt.exe" dans un répertoire vide et placez la dll Windows "sqlite3.dll" dans le même répertoire. Vous aurez alors à lancer "WWCmds.exe" avec la ligne de commande :
	
	$wine WWCmds.exe

ou directement depuis votre application. Vous piloterez alors WotWizard en plaçant une requête GraphQL dans un nouveau fichier "Query/Query.txt". Les requêtes disponibles sont en construction et seront détaillées ultérieurement. La réponse à la requête sera fournie dans un fichier ".json" dans le répertoire "Json".

Il est possible, pendant ce fonctionnement, d'ouvrir ou de fermer à tout moment l'interface utilisateur "WotWizard.exe" afin d'observer le fonctionnement du serveur sans gêner son fonctionnement (voir ci-dessous le Mode Interactif).

Pour arrêter WotWizard, créez un fichier vide "Stop.txt" dans son répertoire. Un arrêt obtenu par une autre méthode peut endommager la base de données de WotWizard (cette base est contenue dans le fichier "Duniter1/DBase.data" ; quand le logiciel est à l'arrêt, vous pouvez en faire des sauvegardes ; à chaque démarrage, une copie "DBase.data.bak" est automatiquement créée).
Mode interactif
Ajoutez aux deux premiers fichiers précédent, le fichier "WotWizard.exe" dans le même répertoire.

Lancez WotWizard en double-cliquant sur le fichier "WotWizard.exe", ou avec la commande en ligne, depuis le répertoire choisi (sous Linux) :
	
	$wine WotWizard.exe
Dans ce cas, où "WotWizard.exe" est lancé en premier, celui-ci se charge de lancer "WWCmds.exe" et "WWUpdt.exe", et de les arrêter lorsqu'il est fermé par l'utilisateur.
Après l'ouverture de la fenêtre, choisissez votre langue (et, éventuellement vos polices de caractères) dans "Édition -> Préférences...".
Vous pouvez alors lancer des commandes avec les menus de l'interface et voir les résultats dans les fenêtres qui souvrent.
Configuration
Vous devez donner à WotWizard deux informations :
	
	- le chemin vers la base de données SQLite de Duniter. En général :
		+ sous linux :
			~/.config/duniter/duniter_default/wotwizard-export.db
		+ sous Windows :
			C:\<Utilisateur>\<nom_utilisateur>\.config\duniter\duniter_default\wotwizard-export.db
		Par défaut :
			D:\.config\duniter\duniter_default\wotwizard-export.db
		Vous pouvez changer cette donnée en créant (ou en modifiant) le fichier "Duniter1/Rsrc/Init.txt" ; attention : le chemin doit être encadré par deux guillemets. Exemple :
			"D:\.config\duniter\duniter_default\wotwizard-export.db"
	
	- la taille maximale de mémoire en octets (approximativement) qu'il a le droit d'allouer.
		Par défaut : 430000000
		Vous pouvez changer cette donnée en créant (ou en modifiant) le fichier "Duniter/Rsrc/Parameters.txt". Plus elle est grande, plus les prévisions de WotWizard seront précises, mais si elle est trop grande, WotWizard peut se bloquer.

Lors de son premier lancement, WotWizard recopie une partie des données de Duniter dans sa propre base pour accélérer ensuite leur traitement. Cette opération peut être assez longue.
La fenêtre WotWizard
Ouvrez la fenêtre WotWizard avec "WotWizard -> Nouvelle fenêtre WotWizard".
Vous pouvez choisir la façon dont la liste est affichée (par noms ou par dates). Sa mise à jour est automatique à chaque apparition d'un nouveau bloc.
Il y a aussi des métadonnées disponibles, analoques au contenu du Fichier (voir ci-sessous).
Lorsque la liste change, deux astérisques encadrent le titre, et un bouton "Vérifier" apparaît. En cliquant sur le bouton, on fait disparaître les astérisques et on peut comparer les anciennes et nouvelles listes (par dates et métadonnées) en cliquant sur le bouton "Comparer", ou en utilisant la commande de menu "Édition -> Comparer les textes" (raccourci clavier : F9). 
Vous pouvez changer la mémoire maximale allouée par la fenêtre WotWizard. Plus elle est grande, plus les prévisions de WotWizard seront précises, mais si elle est trop grande, WotWizard peut se bloquer. Par défaut, elle vaut 430000000 octets. Pour la changer, utilisez la commande de menu "Édition -> Changer les paramètres".
Fichier : WotWizard calcule ses prévisions à partir d'un état des lieux, appelé Fichier. Il s'agit d'une liste de dossiers d'entrées et de certifications internes, triée par dates de disponibilité. Chaque dossier contient le pseudo du nouveau venu et la liste des certifications (externes) qu'il a reçues. Les certifications internes sont émises vers des personnes déjà membres. L'affichage, obtenu par la commande de menu "WotWizard -> Fichier", donne les informations suivantes :
-	Certification interne : une ligne contenant :
+	le récepteur et l'émetteur de la certification (pseudos) séparés par une flèche (←) ;
+	la date et l'heure de disponibilité de la certification ;
+	entre parenthèses, la date et l'heure limite de validité de la certification ;
+	un résumé de l'état de la certification : OK si elle est disponible et valide, ou KO sinon.
-	Dossier :
+	une première ligne décrivant le nouveau venu :
*	le nombre de certifications principales (celles qui déterminent la date de disponibilité du dossier, voir ci-dessous) ;
*	son pseudo ;
*	sa date de disponibilité ;
*	entre parenthèses, la date limite de validité de sa demande d'adhésion ;
*	le résultat du calcul de la règle de distance, en pourcentage de membres référents accessibles ;
*	un résumé de l'état du dossier : OK s'il est valide et si les règles de nombres de certifications valides et de distance sont vérifiées, ou KO sinon (la disponibilité des certifications n'est pas prise en compte) ;
+	une ligne supplémentaire par certification externe, identique à celle d'une certification interne, sauf que le récepteur, qui est le nouveau venu, n'est pas mentionné ; ces certifications sont triées par date de disponibilité. 
Certifications principales : Pour qu'un dossier soit valide, il faut qu'il contienne un nombre minimal de certifications (sigQty = 5), mais aussi que ces certifications lui permettent de vérifier la règle de distance. Du fait de cette règle de distance, il faut parfois plus que sigQty certifications. Les certifications principales d'un dossier sont celles qui permettent, au minimum, le respect des deux règles. Par extension, si l'une des deux règles n'est pas respectée, on considère toutes les règles du dossier comme principales. Comme les certifications passent dans l'ordre de leurs dates de disponibilité, on considère, dans cet ordre, les sigQty premières règles (ou moins si le dossier est incomplet) ; si elles permettent de respecter la règle de distance, on s'arrête là, sinon on continue avec les certifications suivantes jusqu'à ce que la règle de distance soit satisfaite ou qu'on ait épuisé toutes les certifications du dossier: on a alors trouvé les certifications principales. La date de disponibilité de la dernière certification principale est celle du dossier (il ne sera vraiment disponible à cette date que s'il est valide).
Permutations : La commande "WotWizard -> Permutations" affiche toutes les permutations d'ordre d'entrées prévues par WotWizard avec leurs probabilités. Attention : leur nombre peut être très grand et l'affichage très long !
Explorateur de toile de confiance
Ouvrez l'explorateur avec la commande de menu "Toile de confiance -> chercher une identité".

Voir la carte de l'explorateur.
On peut chercher n'importe quelle identité dans la chaîne de blocs ou dans la piscine en tapant ses premiers caractères ou les premiers caractères de sa clé publique dans le premier champ en haut de la fenêtre et en cliquant sur le bouton "Chercher". Les identités correspondantes s'affichent dans la liste en bas de la fenêtre : choisissez celle qui vous intéresse. Des informations apparaissent dans le cadre "Identité", ainsi que les certifications reçues et envoyées dans le cadre "Certifications". Il est possible d'afficher l'identité d'un émetteur ou d'un récepteur de certification en cliquant sur bouton "Voir" correspondant ; on peut revenir en arrière avec les boutons fléchés. On peut aussi afficher un texte d'informations sur les certificateurs et certifiés en cliquant sur l'un des boutons "A" (liste des certificateurs ou certifiés actuels, classés par ordres alphabétiques, par date limite des demandes d'adhésion (ou date limite avant révocation si la personne concernée n'est plus membre - "×" devant le nom) et par dates limites de validité des certifications, et liste de tous les certificateurs ou certifiés ayant existé et non-révoqués et pouvant donc à nouveau soit certifier, soit être certifiés).
Les dates affichées sont la date d'enregistrement du membre dans la chaîne de blocs, les dates limites d'expiration, pour l'inscription du membre et pour ses certifications, et la date de disponibilité de la prochaine certification émise dans le champ "Disponibilité" ; si cette dernière est déjà disponible, elle est précédée d'un point d'exclamation (!). Si le membre a demandé l'arrêt de son adhésion, la date limite de son inscription est précédée d'une croix (×). Dans ce cas, il ne peut plus recevoir de certifications, et, sauf renouvellement de son adhésion, il sera exclu à cette date.
Le degré de centralité c d'un membre est le nombre de chemins orientés (certificateur -> certifié) les plus courts auxquels il appartient est dont la longueur est, au plus, stepMax (5) plus un depuis le certificateur. Le niveau de centralité c' d'un membre est calculé à partir de son degré de centralité c par l'expression :



où  est le maximum de  sur l'ensemble des membres.
On peut considérer le niveau de centralité d'un membre comme son niveau d'implication dans le respect de la règle de distance des membres qu'il a certifiés, sans préjuger de sa capacité à le faire. Par contre, la qualité d'un membre est sa capacité à permettre le respect de la règle de distance par ceux qu'il certifie, sans préjuger de son niveau d'implication.
Un membre qui a une qualité supérieure ou égale à xpercent (= 80%), assure à lui tout seul le respect de la règle de distance par ceux qu'il certifie.
Outils
Paramètres : Affiche les paramètres de base de la monnaie.

Identités révoquées : Affiche les identités révoquées, avec leurs pseudos et clés publiques, et les dates de leurs adhésions.
Adhésions non-renouvelées : Affiche les identités dont l'adhésion n'a pas été renouvelée, avec leurs pseudos et clés publiques, les dates de leurs adhésions et la date limite avant révocation.
Identités : Affiche les identités de tous les membres, avec leurs pseudos et clés publiques, les dates de leurs adhésions et leurs limites de validité.
Certifications depuis... : Affiche toutes les certifications présentes dans la chaîne de blocs, triées par émetteurs, avec leurs dates d'inscription.
Certifications vers... : Affiche toutes les certifications présentes dans la chaîne de blocs, triées par récepteurs, avec leurs dates d'inscription.
Membres référents : Affiche les identités des membres référents.
Piscine : Affiche les identités et les certifications présentes dans la piscine :
1)	Identités triées par leurs hashs, avec hash, clé publique, id et date d'expiration
2) Identités triées par leurs clés publiques, avec clé publique et hash
3) Identités triées par leurs pseudos, avec pseudo et hash
4) Certifications triées par les clés publiques de leurs émetteurs, avec clé publique de l'émetteur, hash du récepteur et date d'expiration
5) Certifications triées par les clés publiques de leurs récepteurs, avec hash du récepteur, clé publique de l'émetteur et date d'expiration
Distances: Affiche les distances de tous les membres à la toile de confiance (proportions des membres référents atteignables en stepMax (5) pas au plus), triées par proportions (avec tracé), puis par pseudo.
Qualités : Affiche les qualités de tous les membres, triées par qualités (avec tracé), puis par pseudo.
Centralités : Affiche les niveaux de centralité de tous les membres, triés par niveaux de centralité (avec tracé), puis par pseudo.
Limites des adhésions : Affiche les dates limites de validité des adhésions de tous les membres, triées par date.
Limites des adhésions non-renouvelées: Affiche les dates limites avant révocation de toutes les identités dont l'adhésion n'a pas été renouvelée, triées par date.
Limites des certifications: Affiche les dates limites de validité des adhésions pour manque de certifications de tous les membres, triées par date.
Évolution
Nombre de membres : Affiche la liste des dates des blocs où le nombre de membres a changé et les nombres  de membres correspondants depuis le début de la monnaie (avec tracé).
Flux de membres : Variation du nombre de membres par unité de temps (ici: le mois). C'est donc la dérivée du nombre de membres par rapport au temps  :  (avec tracé).
Flux de membres par membre : Flux de membres divisé par le nombre  de membres : , en pourcentage par unité de temps. C'est auss la dérivée logarithmique de  par rapport au temps . Lorsque cette valeur reste constante dans le temps,  croît exponentiellement (avec tracé).
Nombre de premières entrées : Affiche la liste des dates des blocs où le nombre de membres entrant pour la première fois dans la toile de confiance a changé et les nombres  de premières entrées correspondantes depuis le début de la monnaie (avec tracé).
Flux de premières entrées : Variation du nombre de premières entrées par unité de temps (ici: le mois). C'est donc la dérivée du nombre de premières entrées par rapport au temps  :  (avec tracé).
Flux de premières entrées par membre : Flux de premières entrées divisé par le nombre  de membres : , en pourcentage par unité de temps (avec tracé).
Nombre de membres jour par jour : Affiche la liste des numéros des jours et des nombres de membres correspondants depuis le début de la monnaie (avec tracé).

Use it and enjoy! - ¡Úsalos y disfrútalos! - Bonne utilisation - Приятного использованияn - Powodzenia - Viel Spaß

Gérard Meunier
