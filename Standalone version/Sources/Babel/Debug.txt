(* 
Babel: a compiler compiler.

Copyright (C) 2001 Gérard Meunier

This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
*)

MODULE BabelDebug;
	
	

	IMPORT
		
		C := BabelCompil, StdLog;
	
	PROCEDURE PrintObj* (o: C.Object);
		
		VAR
			
			s: POINTER TO ARRAY OF CHAR;
		
		PROCEDURE Indent (n: INTEGER);
			
			VAR
				
				i: INTEGER;
			
			BEGIN (*Indent*)
				FOR i := 1 TO n DO
					StdLog.Char(9X);
				END;
			END Indent;
		
		PROCEDURE Print (o: C.Object; level: INTEGER);
			
			VAR
				
				i: INTEGER;
			
			BEGIN (*Print*)
				Indent(level);
				CASE o.ObjType() OF
					|C.stringObj:
						NEW(s, o.ObjStringLen() + 1);
						o.ObjString(s^);
						StdLog.String("String: ");
						StdLog.Int(o.Position() - 1);
						StdLog.Ln; Indent(level + 1);
						StdLog.String(s^);
						StdLog.Ln;
					|C.userObj:
						StdLog.String("User: ");
						StdLog.Int(o.Position() - 1);
						StdLog.Ln; Indent(level + 1);
						StdLog.String("number = ");
						StdLog.Int(o.ObjNum());
						StdLog.String("; function = ");
						StdLog.Int(o.ObjFunc());
						StdLog.Ln;
					|C.termObj:
						StdLog.String("Term:");
						StdLog.Ln; Indent(level + 1);
						StdLog.String("number = ");
						StdLog.Int(o.ObjNum());
						StdLog.String("; function = ");
						StdLog.Int(o.ObjFunc());
						StdLog.Ln;
						FOR i := 1 TO o.ObjTermSonsNb() DO
							Print(o.ObjTermSon(i), level + 1);
						END;
					|C.nulObj:
						StdLog.String("Nul.");
						StdLog.Ln;
				END;
			END Print;
		
		BEGIN (*PrintObj*)
			Print(o, 0);
		END PrintObj;
	
	END BabelDebug.
